{"ast":null,"code":"var _jsxFileName = \"/Users/wuyanqiang/Documents/h5/zqplayer-admin/src/components/widget/PwaInstaller.tsx\";\n\n/*\n * File: PwaInstaller.js\n * Desc: pwa手动触发安装\n * File Created: 2018-11-07 21:13:18\n * Author: chenghao\n *\n * Copyright 2018 - present, chenghao\n */\nimport React, { Component } from 'react';\n\nclass PwaInstaller extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      installed: true\n    };\n    this.deferredPrompt = void 0;\n\n    this.beforeInstallPrompt = e => {\n      console.log('beforeinstallprompt Event fired'); // 未安装PWA应用\n\n      this.setState({\n        installed: false\n      });\n      e.preventDefault(); // Stash the event so it can be triggered later.\n\n      this.deferredPrompt = e;\n      return false;\n    };\n\n    this.download = () => {\n      if (this.deferredPrompt !== undefined) {\n        // The user has had a postive interaction with our app and Chrome\n        // has tried to prompt previously, so let's show the prompt.\n        this.deferredPrompt.prompt(); // Follow what the user has done with the prompt.\n\n        this.deferredPrompt.userChoice.then(choiceResult => {\n          console.log(choiceResult.outcome);\n\n          if (choiceResult.outcome === 'dismissed') {\n            console.log('User cancelled home screen install');\n          } else {\n            console.log('User added to home screen');\n          } // We no longer need the prompt.  Clear it up.\n\n\n          this.deferredPrompt = null;\n        });\n      }\n    };\n  }\n\n  componentDidMount() {\n    window.addEventListener('beforeinstallprompt', this.beforeInstallPrompt);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('beforeinstallprompt', this.beforeInstallPrompt);\n  }\n\n  render() {\n    const installed = this.state.installed;\n    return !installed && React.createElement(\"div\", {\n      className: \"installer\",\n      onClick: this.download,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 54\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"installer__btn\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 55\n      },\n      __self: this\n    }));\n  }\n\n}\n\nexport default PwaInstaller;","map":{"version":3,"sources":["/Users/wuyanqiang/Documents/h5/zqplayer-admin/src/components/widget/PwaInstaller.tsx"],"names":["React","Component","PwaInstaller","state","installed","deferredPrompt","beforeInstallPrompt","e","console","log","setState","preventDefault","download","undefined","prompt","userChoice","then","choiceResult","outcome","componentDidMount","window","addEventListener","componentWillUnmount","removeEventListener","render"],"mappings":";;AAAA;;;;;;;;AAQA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;;AAEA,MAAMC,YAAN,SAA2BD,SAA3B,CAAqC;AAAA;AAAA;AAAA,SACjCE,KADiC,GACzB;AACJC,MAAAA,SAAS,EAAE;AADP,KADyB;AAAA,SAUjCC,cAViC;;AAAA,SAWjCC,mBAXiC,GAWVC,CAAD,IAAc;AAChCC,MAAAA,OAAO,CAACC,GAAR,CAAY,iCAAZ,EADgC,CAEhC;;AACA,WAAKC,QAAL,CAAc;AAAEN,QAAAA,SAAS,EAAE;AAAb,OAAd;AAEAG,MAAAA,CAAC,CAACI,cAAF,GALgC,CAMhC;;AACA,WAAKN,cAAL,GAAsBE,CAAtB;AACA,aAAO,KAAP;AACH,KApBgC;;AAAA,SAqBjCK,QArBiC,GAqBtB,MAAM;AACb,UAAI,KAAKP,cAAL,KAAwBQ,SAA5B,EAAuC;AACnC;AACA;AACA,aAAKR,cAAL,CAAoBS,MAApB,GAHmC,CAInC;;AACA,aAAKT,cAAL,CAAoBU,UAApB,CAA+BC,IAA/B,CAAqCC,YAAD,IAAuB;AACvDT,UAAAA,OAAO,CAACC,GAAR,CAAYQ,YAAY,CAACC,OAAzB;;AACA,cAAID,YAAY,CAACC,OAAb,KAAyB,WAA7B,EAA0C;AACtCV,YAAAA,OAAO,CAACC,GAAR,CAAY,oCAAZ;AACH,WAFD,MAEO;AACHD,YAAAA,OAAO,CAACC,GAAR,CAAY,2BAAZ;AACH,WANsD,CAOvD;;;AACA,eAAKJ,cAAL,GAAsB,IAAtB;AACH,SATD;AAUH;AACJ,KAtCgC;AAAA;;AAIjCc,EAAAA,iBAAiB,GAAG;AAChBC,IAAAA,MAAM,CAACC,gBAAP,CAAwB,qBAAxB,EAA+C,KAAKf,mBAApD;AACH;;AACDgB,EAAAA,oBAAoB,GAAG;AACnBF,IAAAA,MAAM,CAACG,mBAAP,CAA2B,qBAA3B,EAAkD,KAAKjB,mBAAvD;AACH;;AA8BDkB,EAAAA,MAAM,GAAG;AAAA,UACGpB,SADH,GACiB,KAAKD,KADtB,CACGC,SADH;AAEL,WACI,CAACA,SAAD,IACI;AAAK,MAAA,SAAS,EAAC,WAAf;AAA2B,MAAA,OAAO,EAAE,KAAKQ,QAAzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAK,MAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,CAFR;AAOH;;AAhDgC;;AAmDrC,eAAeV,YAAf","sourcesContent":["/*\n * File: PwaInstaller.js\n * Desc: pwa手动触发安装\n * File Created: 2018-11-07 21:13:18\n * Author: chenghao\n *\n * Copyright 2018 - present, chenghao\n */\nimport React, { Component } from 'react';\n\nclass PwaInstaller extends Component {\n    state = {\n        installed: true,\n    };\n    componentDidMount() {\n        window.addEventListener('beforeinstallprompt', this.beforeInstallPrompt);\n    }\n    componentWillUnmount() {\n        window.removeEventListener('beforeinstallprompt', this.beforeInstallPrompt);\n    }\n    deferredPrompt: any;\n    beforeInstallPrompt = (e: Event) => {\n        console.log('beforeinstallprompt Event fired');\n        // 未安装PWA应用\n        this.setState({ installed: false });\n\n        e.preventDefault();\n        // Stash the event so it can be triggered later.\n        this.deferredPrompt = e;\n        return false;\n    };\n    download = () => {\n        if (this.deferredPrompt !== undefined) {\n            // The user has had a postive interaction with our app and Chrome\n            // has tried to prompt previously, so let's show the prompt.\n            this.deferredPrompt.prompt();\n            // Follow what the user has done with the prompt.\n            this.deferredPrompt.userChoice.then((choiceResult: any) => {\n                console.log(choiceResult.outcome);\n                if (choiceResult.outcome === 'dismissed') {\n                    console.log('User cancelled home screen install');\n                } else {\n                    console.log('User added to home screen');\n                }\n                // We no longer need the prompt.  Clear it up.\n                this.deferredPrompt = null;\n            });\n        }\n    };\n    render() {\n        const { installed } = this.state;\n        return (\n            !installed && (\n                <div className=\"installer\" onClick={this.download}>\n                    <div className=\"installer__btn\" />\n                </div>\n            )\n        );\n    }\n}\n\nexport default PwaInstaller;\n"]},"metadata":{},"sourceType":"module"}